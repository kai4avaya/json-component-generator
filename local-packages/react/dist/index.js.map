{"version":3,"sources":["../src/index.ts","../src/contexts/data.tsx","../src/contexts/visibility.tsx","../src/contexts/actions.tsx","../src/contexts/validation.tsx","../src/renderer.tsx","../src/hooks.ts"],"sourcesContent":["// Contexts\r\nexport {\r\n  DataProvider,\r\n  useData,\r\n  useDataValue,\r\n  useDataBinding,\r\n  type DataContextValue,\r\n  type DataProviderProps,\r\n} from \"./contexts/data\";\r\n\r\nexport {\r\n  VisibilityProvider,\r\n  useVisibility,\r\n  useIsVisible,\r\n  type VisibilityContextValue,\r\n  type VisibilityProviderProps,\r\n} from \"./contexts/visibility\";\r\n\r\nexport {\r\n  ActionProvider,\r\n  useActions,\r\n  useAction,\r\n  ConfirmDialog,\r\n  type ActionContextValue,\r\n  type ActionProviderProps,\r\n  type PendingConfirmation,\r\n  type ConfirmDialogProps,\r\n} from \"./contexts/actions\";\r\n\r\nexport {\r\n  ValidationProvider,\r\n  useValidation,\r\n  useFieldValidation,\r\n  type ValidationContextValue,\r\n  type ValidationProviderProps,\r\n  type FieldValidationState,\r\n} from \"./contexts/validation\";\r\n\r\n// Renderer\r\nexport {\r\n  Renderer,\r\n  JSONUIProvider,\r\n  createRendererFromCatalog,\r\n  type ComponentRenderProps,\r\n  type ComponentRenderer,\r\n  type ComponentRegistry,\r\n  type RendererProps,\r\n  type JSONUIProviderProps,\r\n} from \"./renderer\";\r\n\r\n// Hooks\r\nexport {\r\n  useUIStream,\r\n  flatToTree,\r\n  type UseUIStreamOptions,\r\n  type UseUIStreamReturn,\r\n} from \"./hooks\";\r\n","\"use client\";\r\n\r\nimport React, {\r\n  createContext,\r\n  useContext,\r\n  useState,\r\n  useCallback,\r\n  useMemo,\r\n  type ReactNode,\r\n} from \"react\";\r\nimport {\r\n  getByPath,\r\n  setByPath,\r\n  type DataModel,\r\n  type AuthState,\r\n} from \"@json-render/core\";\r\n\r\n/**\r\n * Data context value\r\n */\r\nexport interface DataContextValue {\r\n  /** The current data model */\r\n  data: DataModel;\r\n  /** Auth state for visibility evaluation */\r\n  authState?: AuthState;\r\n  /** Get a value by path */\r\n  get: (path: string) => unknown;\r\n  /** Set a value by path */\r\n  set: (path: string, value: unknown) => void;\r\n  /** Update multiple values at once */\r\n  update: (updates: Record<string, unknown>) => void;\r\n}\r\n\r\nconst DataContext = createContext<DataContextValue | null>(null);\r\n\r\n/**\r\n * Props for DataProvider\r\n */\r\nexport interface DataProviderProps {\r\n  /** Initial data model */\r\n  initialData?: DataModel;\r\n  /** Auth state */\r\n  authState?: AuthState;\r\n  /** Callback when data changes */\r\n  onDataChange?: (path: string, value: unknown) => void;\r\n  children: ReactNode;\r\n}\r\n\r\n/**\r\n * Provider for data model context\r\n */\r\nexport function DataProvider({\r\n  initialData = {},\r\n  authState,\r\n  onDataChange,\r\n  children,\r\n}: DataProviderProps) {\r\n  const [data, setData] = useState<DataModel>(initialData);\r\n\r\n  const get = useCallback((path: string) => getByPath(data, path), [data]);\r\n\r\n  const set = useCallback(\r\n    (path: string, value: unknown) => {\r\n      setData((prev) => {\r\n        const next = { ...prev };\r\n        setByPath(next, path, value);\r\n        return next;\r\n      });\r\n      onDataChange?.(path, value);\r\n    },\r\n    [onDataChange],\r\n  );\r\n\r\n  const update = useCallback(\r\n    (updates: Record<string, unknown>) => {\r\n      setData((prev) => {\r\n        const next = { ...prev };\r\n        for (const [path, value] of Object.entries(updates)) {\r\n          setByPath(next, path, value);\r\n          onDataChange?.(path, value);\r\n        }\r\n        return next;\r\n      });\r\n    },\r\n    [onDataChange],\r\n  );\r\n\r\n  const value = useMemo<DataContextValue>(\r\n    () => ({\r\n      data,\r\n      authState,\r\n      get,\r\n      set,\r\n      update,\r\n    }),\r\n    [data, authState, get, set, update],\r\n  );\r\n\r\n  return <DataContext.Provider value={value}>{children}</DataContext.Provider>;\r\n}\r\n\r\n/**\r\n * Hook to access the data context\r\n */\r\nexport function useData(): DataContextValue {\r\n  const ctx = useContext(DataContext);\r\n  if (!ctx) {\r\n    throw new Error(\"useData must be used within a DataProvider\");\r\n  }\r\n  return ctx;\r\n}\r\n\r\n/**\r\n * Hook to get a value from the data model\r\n */\r\nexport function useDataValue<T>(path: string): T | undefined {\r\n  const { get } = useData();\r\n  return get(path) as T | undefined;\r\n}\r\n\r\n/**\r\n * Hook to get and set a value from the data model (like useState)\r\n */\r\nexport function useDataBinding<T>(\r\n  path: string,\r\n): [T | undefined, (value: T) => void] {\r\n  const { get, set } = useData();\r\n  const value = get(path) as T | undefined;\r\n  const setValue = useCallback(\r\n    (newValue: T) => set(path, newValue),\r\n    [path, set],\r\n  );\r\n  return [value, setValue];\r\n}\r\n","\"use client\";\r\n\r\nimport React, {\r\n  createContext,\r\n  useContext,\r\n  useMemo,\r\n  type ReactNode,\r\n} from \"react\";\r\nimport {\r\n  evaluateVisibility,\r\n  type VisibilityCondition,\r\n  type VisibilityContext as CoreVisibilityContext,\r\n} from \"@json-render/core\";\r\nimport { useData } from \"./data\";\r\n\r\n/**\r\n * Visibility context value\r\n */\r\nexport interface VisibilityContextValue {\r\n  /** Evaluate a visibility condition */\r\n  isVisible: (condition: VisibilityCondition | undefined) => boolean;\r\n  /** The underlying visibility context */\r\n  ctx: CoreVisibilityContext;\r\n}\r\n\r\nconst VisibilityContext = createContext<VisibilityContextValue | null>(null);\r\n\r\n/**\r\n * Props for VisibilityProvider\r\n */\r\nexport interface VisibilityProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\n/**\r\n * Provider for visibility evaluation\r\n */\r\nexport function VisibilityProvider({ children }: VisibilityProviderProps) {\r\n  const { data, authState } = useData();\r\n\r\n  const ctx: CoreVisibilityContext = useMemo(\r\n    () => ({\r\n      dataModel: data,\r\n      authState,\r\n    }),\r\n    [data, authState],\r\n  );\r\n\r\n  const isVisible = useMemo(\r\n    () => (condition: VisibilityCondition | undefined) =>\r\n      evaluateVisibility(condition, ctx),\r\n    [ctx],\r\n  );\r\n\r\n  const value = useMemo<VisibilityContextValue>(\r\n    () => ({ isVisible, ctx }),\r\n    [isVisible, ctx],\r\n  );\r\n\r\n  return (\r\n    <VisibilityContext.Provider value={value}>\r\n      {children}\r\n    </VisibilityContext.Provider>\r\n  );\r\n}\r\n\r\n/**\r\n * Hook to access visibility evaluation\r\n */\r\nexport function useVisibility(): VisibilityContextValue {\r\n  const ctx = useContext(VisibilityContext);\r\n  if (!ctx) {\r\n    throw new Error(\"useVisibility must be used within a VisibilityProvider\");\r\n  }\r\n  return ctx;\r\n}\r\n\r\n/**\r\n * Hook to check if a condition is visible\r\n */\r\nexport function useIsVisible(\r\n  condition: VisibilityCondition | undefined,\r\n): boolean {\r\n  const { isVisible } = useVisibility();\r\n  return isVisible(condition);\r\n}\r\n","\"use client\";\r\n\r\nimport React, {\r\n  createContext,\r\n  useContext,\r\n  useState,\r\n  useCallback,\r\n  useMemo,\r\n  type ReactNode,\r\n} from \"react\";\r\nimport {\r\n  resolveAction,\r\n  executeAction,\r\n  type Action,\r\n  type ActionHandler,\r\n  type ActionConfirm,\r\n  type ResolvedAction,\r\n} from \"@json-render/core\";\r\nimport { useData } from \"./data\";\r\n\r\n/**\r\n * Pending confirmation state\r\n */\r\nexport interface PendingConfirmation {\r\n  /** The resolved action */\r\n  action: ResolvedAction;\r\n  /** The action handler */\r\n  handler: ActionHandler;\r\n  /** Resolve callback */\r\n  resolve: () => void;\r\n  /** Reject callback */\r\n  reject: () => void;\r\n}\r\n\r\n/**\r\n * Action context value\r\n */\r\nexport interface ActionContextValue {\r\n  /** Registered action handlers */\r\n  handlers: Record<string, ActionHandler>;\r\n  /** Currently loading action names */\r\n  loadingActions: Set<string>;\r\n  /** Pending confirmation dialog */\r\n  pendingConfirmation: PendingConfirmation | null;\r\n  /** Execute an action */\r\n  execute: (action: Action) => Promise<void>;\r\n  /** Confirm the pending action */\r\n  confirm: () => void;\r\n  /** Cancel the pending action */\r\n  cancel: () => void;\r\n  /** Register an action handler */\r\n  registerHandler: (name: string, handler: ActionHandler) => void;\r\n}\r\n\r\nconst ActionContext = createContext<ActionContextValue | null>(null);\r\n\r\n/**\r\n * Props for ActionProvider\r\n */\r\nexport interface ActionProviderProps {\r\n  /** Initial action handlers */\r\n  handlers?: Record<string, ActionHandler>;\r\n  /** Navigation function */\r\n  navigate?: (path: string) => void;\r\n  children: ReactNode;\r\n}\r\n\r\n/**\r\n * Provider for action execution\r\n */\r\nexport function ActionProvider({\r\n  handlers: initialHandlers = {},\r\n  navigate,\r\n  children,\r\n}: ActionProviderProps) {\r\n  const { data, set } = useData();\r\n  const [handlers, setHandlers] =\r\n    useState<Record<string, ActionHandler>>(initialHandlers);\r\n  const [loadingActions, setLoadingActions] = useState<Set<string>>(new Set());\r\n  const [pendingConfirmation, setPendingConfirmation] =\r\n    useState<PendingConfirmation | null>(null);\r\n\r\n  const registerHandler = useCallback(\r\n    (name: string, handler: ActionHandler) => {\r\n      setHandlers((prev) => ({ ...prev, [name]: handler }));\r\n    },\r\n    [],\r\n  );\r\n\r\n  const execute = useCallback(\r\n    async (action: Action) => {\r\n      const resolved = resolveAction(action, data);\r\n      const handler = handlers[resolved.name];\r\n\r\n      if (!handler) {\r\n        console.warn(`No handler registered for action: ${resolved.name}`);\r\n        return;\r\n      }\r\n\r\n      // If confirmation is required, show dialog\r\n      if (resolved.confirm) {\r\n        return new Promise<void>((resolve, reject) => {\r\n          setPendingConfirmation({\r\n            action: resolved,\r\n            handler,\r\n            resolve: () => {\r\n              setPendingConfirmation(null);\r\n              resolve();\r\n            },\r\n            reject: () => {\r\n              setPendingConfirmation(null);\r\n              reject(new Error(\"Action cancelled\"));\r\n            },\r\n          });\r\n        }).then(async () => {\r\n          setLoadingActions((prev) => new Set(prev).add(resolved.name));\r\n          try {\r\n            await executeAction({\r\n              action: resolved,\r\n              handler,\r\n              setData: set,\r\n              navigate,\r\n              executeAction: async (name) => {\r\n                const subAction: Action = { name };\r\n                await execute(subAction);\r\n              },\r\n            });\r\n          } finally {\r\n            setLoadingActions((prev) => {\r\n              const next = new Set(prev);\r\n              next.delete(resolved.name);\r\n              return next;\r\n            });\r\n          }\r\n        });\r\n      }\r\n\r\n      // Execute immediately\r\n      setLoadingActions((prev) => new Set(prev).add(resolved.name));\r\n      try {\r\n        await executeAction({\r\n          action: resolved,\r\n          handler,\r\n          setData: set,\r\n          navigate,\r\n          executeAction: async (name) => {\r\n            const subAction: Action = { name };\r\n            await execute(subAction);\r\n          },\r\n        });\r\n      } finally {\r\n        setLoadingActions((prev) => {\r\n          const next = new Set(prev);\r\n          next.delete(resolved.name);\r\n          return next;\r\n        });\r\n      }\r\n    },\r\n    [data, handlers, set, navigate],\r\n  );\r\n\r\n  const confirm = useCallback(() => {\r\n    pendingConfirmation?.resolve();\r\n  }, [pendingConfirmation]);\r\n\r\n  const cancel = useCallback(() => {\r\n    pendingConfirmation?.reject();\r\n  }, [pendingConfirmation]);\r\n\r\n  const value = useMemo<ActionContextValue>(\r\n    () => ({\r\n      handlers,\r\n      loadingActions,\r\n      pendingConfirmation,\r\n      execute,\r\n      confirm,\r\n      cancel,\r\n      registerHandler,\r\n    }),\r\n    [\r\n      handlers,\r\n      loadingActions,\r\n      pendingConfirmation,\r\n      execute,\r\n      confirm,\r\n      cancel,\r\n      registerHandler,\r\n    ],\r\n  );\r\n\r\n  return (\r\n    <ActionContext.Provider value={value}>{children}</ActionContext.Provider>\r\n  );\r\n}\r\n\r\n/**\r\n * Hook to access action context\r\n */\r\nexport function useActions(): ActionContextValue {\r\n  const ctx = useContext(ActionContext);\r\n  if (!ctx) {\r\n    throw new Error(\"useActions must be used within an ActionProvider\");\r\n  }\r\n  return ctx;\r\n}\r\n\r\n/**\r\n * Hook to execute an action\r\n */\r\nexport function useAction(action: Action): {\r\n  execute: () => Promise<void>;\r\n  isLoading: boolean;\r\n} {\r\n  const { execute, loadingActions } = useActions();\r\n  const isLoading = loadingActions.has(action.name);\r\n\r\n  const executeAction = useCallback(() => execute(action), [execute, action]);\r\n\r\n  return { execute: executeAction, isLoading };\r\n}\r\n\r\n/**\r\n * Props for ConfirmDialog component\r\n */\r\nexport interface ConfirmDialogProps {\r\n  /** The confirmation config */\r\n  confirm: ActionConfirm;\r\n  /** Called when confirmed */\r\n  onConfirm: () => void;\r\n  /** Called when cancelled */\r\n  onCancel: () => void;\r\n}\r\n\r\n/**\r\n * Default confirmation dialog component\r\n */\r\nexport function ConfirmDialog({\r\n  confirm,\r\n  onConfirm,\r\n  onCancel,\r\n}: ConfirmDialogProps) {\r\n  const isDanger = confirm.variant === \"danger\";\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: \"fixed\",\r\n        inset: 0,\r\n        backgroundColor: \"rgba(0, 0, 0, 0.5)\",\r\n        display: \"flex\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"center\",\r\n        zIndex: 50,\r\n      }}\r\n      onClick={onCancel}\r\n    >\r\n      <div\r\n        style={{\r\n          backgroundColor: \"white\",\r\n          borderRadius: \"8px\",\r\n          padding: \"24px\",\r\n          maxWidth: \"400px\",\r\n          width: \"100%\",\r\n          boxShadow: \"0 20px 25px -5px rgba(0, 0, 0, 0.1)\",\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <h3\r\n          style={{\r\n            margin: \"0 0 8px 0\",\r\n            fontSize: \"18px\",\r\n            fontWeight: 600,\r\n          }}\r\n        >\r\n          {confirm.title}\r\n        </h3>\r\n        <p\r\n          style={{\r\n            margin: \"0 0 24px 0\",\r\n            color: \"#6b7280\",\r\n          }}\r\n        >\r\n          {confirm.message}\r\n        </p>\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            gap: \"12px\",\r\n            justifyContent: \"flex-end\",\r\n          }}\r\n        >\r\n          <button\r\n            onClick={onCancel}\r\n            style={{\r\n              padding: \"8px 16px\",\r\n              borderRadius: \"6px\",\r\n              border: \"1px solid #d1d5db\",\r\n              backgroundColor: \"white\",\r\n              cursor: \"pointer\",\r\n            }}\r\n          >\r\n            {confirm.cancelLabel ?? \"Cancel\"}\r\n          </button>\r\n          <button\r\n            onClick={onConfirm}\r\n            style={{\r\n              padding: \"8px 16px\",\r\n              borderRadius: \"6px\",\r\n              border: \"none\",\r\n              backgroundColor: isDanger ? \"#dc2626\" : \"#3b82f6\",\r\n              color: \"white\",\r\n              cursor: \"pointer\",\r\n            }}\r\n          >\r\n            {confirm.confirmLabel ?? \"Confirm\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, {\r\n  createContext,\r\n  useContext,\r\n  useState,\r\n  useCallback,\r\n  useMemo,\r\n  type ReactNode,\r\n} from \"react\";\r\nimport {\r\n  runValidation,\r\n  type ValidationConfig,\r\n  type ValidationFunction,\r\n  type ValidationResult,\r\n} from \"@json-render/core\";\r\nimport { useData } from \"./data\";\r\n\r\n/**\r\n * Field validation state\r\n */\r\nexport interface FieldValidationState {\r\n  /** Whether the field has been touched */\r\n  touched: boolean;\r\n  /** Whether the field has been validated */\r\n  validated: boolean;\r\n  /** Validation result */\r\n  result: ValidationResult | null;\r\n}\r\n\r\n/**\r\n * Validation context value\r\n */\r\nexport interface ValidationContextValue {\r\n  /** Custom validation functions from catalog */\r\n  customFunctions: Record<string, ValidationFunction>;\r\n  /** Validation state by field path */\r\n  fieldStates: Record<string, FieldValidationState>;\r\n  /** Validate a field */\r\n  validate: (path: string, config: ValidationConfig) => ValidationResult;\r\n  /** Mark field as touched */\r\n  touch: (path: string) => void;\r\n  /** Clear validation for a field */\r\n  clear: (path: string) => void;\r\n  /** Validate all fields */\r\n  validateAll: () => boolean;\r\n  /** Register field config */\r\n  registerField: (path: string, config: ValidationConfig) => void;\r\n}\r\n\r\nconst ValidationContext = createContext<ValidationContextValue | null>(null);\r\n\r\n/**\r\n * Props for ValidationProvider\r\n */\r\nexport interface ValidationProviderProps {\r\n  /** Custom validation functions from catalog */\r\n  customFunctions?: Record<string, ValidationFunction>;\r\n  children: ReactNode;\r\n}\r\n\r\n/**\r\n * Provider for validation\r\n */\r\nexport function ValidationProvider({\r\n  customFunctions = {},\r\n  children,\r\n}: ValidationProviderProps) {\r\n  const { data, authState } = useData();\r\n  const [fieldStates, setFieldStates] = useState<\r\n    Record<string, FieldValidationState>\r\n  >({});\r\n  const [fieldConfigs, setFieldConfigs] = useState<\r\n    Record<string, ValidationConfig>\r\n  >({});\r\n\r\n  const registerField = useCallback(\r\n    (path: string, config: ValidationConfig) => {\r\n      setFieldConfigs((prev) => ({ ...prev, [path]: config }));\r\n    },\r\n    [],\r\n  );\r\n\r\n  const validate = useCallback(\r\n    (path: string, config: ValidationConfig): ValidationResult => {\r\n      const value = data[path.split(\"/\").filter(Boolean).join(\".\")];\r\n      const result = runValidation(config, {\r\n        value,\r\n        dataModel: data,\r\n        customFunctions,\r\n        authState,\r\n      });\r\n\r\n      setFieldStates((prev) => ({\r\n        ...prev,\r\n        [path]: {\r\n          touched: prev[path]?.touched ?? true,\r\n          validated: true,\r\n          result,\r\n        },\r\n      }));\r\n\r\n      return result;\r\n    },\r\n    [data, customFunctions, authState],\r\n  );\r\n\r\n  const touch = useCallback((path: string) => {\r\n    setFieldStates((prev) => ({\r\n      ...prev,\r\n      [path]: {\r\n        ...prev[path],\r\n        touched: true,\r\n        validated: prev[path]?.validated ?? false,\r\n        result: prev[path]?.result ?? null,\r\n      },\r\n    }));\r\n  }, []);\r\n\r\n  const clear = useCallback((path: string) => {\r\n    setFieldStates((prev) => {\r\n      const { [path]: _, ...rest } = prev;\r\n      return rest;\r\n    });\r\n  }, []);\r\n\r\n  const validateAll = useCallback(() => {\r\n    let allValid = true;\r\n\r\n    for (const [path, config] of Object.entries(fieldConfigs)) {\r\n      const result = validate(path, config);\r\n      if (!result.valid) {\r\n        allValid = false;\r\n      }\r\n    }\r\n\r\n    return allValid;\r\n  }, [fieldConfigs, validate]);\r\n\r\n  const value = useMemo<ValidationContextValue>(\r\n    () => ({\r\n      customFunctions,\r\n      fieldStates,\r\n      validate,\r\n      touch,\r\n      clear,\r\n      validateAll,\r\n      registerField,\r\n    }),\r\n    [\r\n      customFunctions,\r\n      fieldStates,\r\n      validate,\r\n      touch,\r\n      clear,\r\n      validateAll,\r\n      registerField,\r\n    ],\r\n  );\r\n\r\n  return (\r\n    <ValidationContext.Provider value={value}>\r\n      {children}\r\n    </ValidationContext.Provider>\r\n  );\r\n}\r\n\r\n/**\r\n * Hook to access validation context\r\n */\r\nexport function useValidation(): ValidationContextValue {\r\n  const ctx = useContext(ValidationContext);\r\n  if (!ctx) {\r\n    throw new Error(\"useValidation must be used within a ValidationProvider\");\r\n  }\r\n  return ctx;\r\n}\r\n\r\n/**\r\n * Hook to get validation state for a field\r\n */\r\nexport function useFieldValidation(\r\n  path: string,\r\n  config?: ValidationConfig,\r\n): {\r\n  state: FieldValidationState;\r\n  validate: () => ValidationResult;\r\n  touch: () => void;\r\n  clear: () => void;\r\n  errors: string[];\r\n  isValid: boolean;\r\n} {\r\n  const {\r\n    fieldStates,\r\n    validate: validateField,\r\n    touch: touchField,\r\n    clear: clearField,\r\n    registerField,\r\n  } = useValidation();\r\n\r\n  // Register field on mount\r\n  React.useEffect(() => {\r\n    if (config) {\r\n      registerField(path, config);\r\n    }\r\n  }, [path, config, registerField]);\r\n\r\n  const state = fieldStates[path] ?? {\r\n    touched: false,\r\n    validated: false,\r\n    result: null,\r\n  };\r\n\r\n  const validate = useCallback(\r\n    () => validateField(path, config ?? { checks: [] }),\r\n    [path, config, validateField],\r\n  );\r\n\r\n  const touch = useCallback(() => touchField(path), [path, touchField]);\r\n  const clear = useCallback(() => clearField(path), [path, clearField]);\r\n\r\n  return {\r\n    state,\r\n    validate,\r\n    touch,\r\n    clear,\r\n    errors: state.result?.errors ?? [],\r\n    isValid: state.result?.valid ?? true,\r\n  };\r\n}\r\n","\"use client\";\r\n\r\nimport React, { type ComponentType, type ReactNode, useMemo } from \"react\";\r\nimport type {\r\n  UIElement,\r\n  UITree,\r\n  Action,\r\n  Catalog,\r\n  ComponentDefinition,\r\n} from \"@json-render/core\";\r\nimport { useIsVisible } from \"./contexts/visibility\";\r\nimport { useActions } from \"./contexts/actions\";\r\nimport { useData } from \"./contexts/data\";\r\n\r\n/**\r\n * Props passed to component renderers\r\n */\r\nexport interface ComponentRenderProps<P = Record<string, unknown>> {\r\n  /** The element being rendered */\r\n  element: UIElement<string, P>;\r\n  /** Rendered children */\r\n  children?: ReactNode;\r\n  /** Execute an action */\r\n  onAction?: (action: Action) => void;\r\n  /** Whether the parent is loading */\r\n  loading?: boolean;\r\n}\r\n\r\n/**\r\n * Component renderer type\r\n */\r\nexport type ComponentRenderer<P = Record<string, unknown>> = ComponentType<\r\n  ComponentRenderProps<P>\r\n>;\r\n\r\n/**\r\n * Registry of component renderers\r\n */\r\nexport type ComponentRegistry = Record<string, ComponentRenderer<any>>;\r\n\r\n/**\r\n * Props for the Renderer component\r\n */\r\nexport interface RendererProps {\r\n  /** The UI tree to render */\r\n  tree: UITree | null;\r\n  /** Component registry */\r\n  registry: ComponentRegistry;\r\n  /** Whether the tree is currently loading/streaming */\r\n  loading?: boolean;\r\n  /** Fallback component for unknown types */\r\n  fallback?: ComponentRenderer;\r\n}\r\n\r\n/**\r\n * Element renderer component\r\n */\r\nfunction ElementRenderer({\r\n  element,\r\n  tree,\r\n  registry,\r\n  loading,\r\n  fallback,\r\n}: {\r\n  element: UIElement;\r\n  tree: UITree;\r\n  registry: ComponentRegistry;\r\n  loading?: boolean;\r\n  fallback?: ComponentRenderer;\r\n}) {\r\n  const isVisible = useIsVisible(element.visible);\r\n  const { execute } = useActions();\r\n\r\n  // Don't render if not visible\r\n  if (!isVisible) {\r\n    return null;\r\n  }\r\n\r\n  // Get the component renderer\r\n  const Component = registry[element.type] ?? fallback;\r\n\r\n  if (!Component) {\r\n    console.warn(`No renderer for component type: ${element.type}`);\r\n    return null;\r\n  }\r\n\r\n  // Render children\r\n  const children = element.children?.map((childKey) => {\r\n    const childElement = tree.elements[childKey];\r\n    if (!childElement) {\r\n      return null;\r\n    }\r\n    return (\r\n      <ElementRenderer\r\n        key={childKey}\r\n        element={childElement}\r\n        tree={tree}\r\n        registry={registry}\r\n        loading={loading}\r\n        fallback={fallback}\r\n      />\r\n    );\r\n  });\r\n\r\n  return (\r\n    <Component element={element} onAction={execute} loading={loading}>\r\n      {children}\r\n    </Component>\r\n  );\r\n}\r\n\r\n/**\r\n * Main renderer component\r\n */\r\nexport function Renderer({ tree, registry, loading, fallback }: RendererProps) {\r\n  if (!tree || !tree.root) {\r\n    return null;\r\n  }\r\n\r\n  const rootElement = tree.elements[tree.root];\r\n  if (!rootElement) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <ElementRenderer\r\n      element={rootElement}\r\n      tree={tree}\r\n      registry={registry}\r\n      loading={loading}\r\n      fallback={fallback}\r\n    />\r\n  );\r\n}\r\n\r\n/**\r\n * Props for JSONUIProvider\r\n */\r\nexport interface JSONUIProviderProps {\r\n  /** Component registry */\r\n  registry: ComponentRegistry;\r\n  /** Initial data model */\r\n  initialData?: Record<string, unknown>;\r\n  /** Auth state */\r\n  authState?: { isSignedIn: boolean; user?: Record<string, unknown> };\r\n  /** Action handlers */\r\n  actionHandlers?: Record<\r\n    string,\r\n    (params: Record<string, unknown>) => Promise<unknown> | unknown\r\n  >;\r\n  /** Navigation function */\r\n  navigate?: (path: string) => void;\r\n  /** Custom validation functions */\r\n  validationFunctions?: Record<\r\n    string,\r\n    (value: unknown, args?: Record<string, unknown>) => boolean\r\n  >;\r\n  /** Callback when data changes */\r\n  onDataChange?: (path: string, value: unknown) => void;\r\n  children: ReactNode;\r\n}\r\n\r\n// Import the providers\r\nimport { DataProvider } from \"./contexts/data\";\r\nimport { VisibilityProvider } from \"./contexts/visibility\";\r\nimport { ActionProvider } from \"./contexts/actions\";\r\nimport { ValidationProvider } from \"./contexts/validation\";\r\nimport { ConfirmDialog } from \"./contexts/actions\";\r\n\r\n/**\r\n * Combined provider for all JSONUI contexts\r\n */\r\nexport function JSONUIProvider({\r\n  registry,\r\n  initialData,\r\n  authState,\r\n  actionHandlers,\r\n  navigate,\r\n  validationFunctions,\r\n  onDataChange,\r\n  children,\r\n}: JSONUIProviderProps) {\r\n  return (\r\n    <DataProvider\r\n      initialData={initialData}\r\n      authState={authState}\r\n      onDataChange={onDataChange}\r\n    >\r\n      <VisibilityProvider>\r\n        <ActionProvider handlers={actionHandlers} navigate={navigate}>\r\n          <ValidationProvider customFunctions={validationFunctions}>\r\n            {children}\r\n            <ConfirmationDialogManager />\r\n          </ValidationProvider>\r\n        </ActionProvider>\r\n      </VisibilityProvider>\r\n    </DataProvider>\r\n  );\r\n}\r\n\r\n/**\r\n * Renders the confirmation dialog when needed\r\n */\r\nfunction ConfirmationDialogManager() {\r\n  const { pendingConfirmation, confirm, cancel } = useActions();\r\n\r\n  if (!pendingConfirmation?.action.confirm) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <ConfirmDialog\r\n      confirm={pendingConfirmation.action.confirm}\r\n      onConfirm={confirm}\r\n      onCancel={cancel}\r\n    />\r\n  );\r\n}\r\n\r\n/**\r\n * Helper to create a renderer component from a catalog\r\n */\r\nexport function createRendererFromCatalog<\r\n  C extends Catalog<Record<string, ComponentDefinition>>,\r\n>(\r\n  _catalog: C,\r\n  registry: ComponentRegistry,\r\n): ComponentType<Omit<RendererProps, \"registry\">> {\r\n  return function CatalogRenderer(props: Omit<RendererProps, \"registry\">) {\r\n    return <Renderer {...props} registry={registry} />;\r\n  };\r\n}\r\n","\"use client\";\r\n\r\nimport { useState, useCallback, useRef, useEffect } from \"react\";\r\nimport type { UITree, UIElement, JsonPatch } from \"@json-render/core\";\r\nimport { setByPath } from \"@json-render/core\";\r\n\r\n/**\r\n * Parse a single JSON patch line\r\n */\r\nfunction parsePatchLine(line: string): JsonPatch | null {\r\n  try {\r\n    const trimmed = line.trim();\r\n    if (!trimmed || trimmed.startsWith(\"//\")) {\r\n      return null;\r\n    }\r\n    return JSON.parse(trimmed) as JsonPatch;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Apply a JSON patch to the current tree\r\n */\r\nfunction applyPatch(tree: UITree, patch: JsonPatch): UITree {\r\n  const newTree = { ...tree, elements: { ...tree.elements } };\r\n\r\n  switch (patch.op) {\r\n    case \"set\":\r\n    case \"add\":\r\n    case \"replace\": {\r\n      // Handle root path\r\n      if (patch.path === \"/root\") {\r\n        newTree.root = patch.value as string;\r\n        return newTree;\r\n      }\r\n\r\n      // Handle elements paths\r\n      if (patch.path.startsWith(\"/elements/\")) {\r\n        const pathParts = patch.path.slice(\"/elements/\".length).split(\"/\");\r\n        const elementKey = pathParts[0];\r\n\r\n        if (!elementKey) return newTree;\r\n\r\n        if (pathParts.length === 1) {\r\n          // Setting entire element\r\n          newTree.elements[elementKey] = patch.value as UIElement;\r\n        } else {\r\n          // Setting property of element\r\n          const element = newTree.elements[elementKey];\r\n          if (element) {\r\n            const propPath = \"/\" + pathParts.slice(1).join(\"/\");\r\n            const newElement = { ...element };\r\n            setByPath(\r\n              newElement as unknown as Record<string, unknown>,\r\n              propPath,\r\n              patch.value,\r\n            );\r\n            newTree.elements[elementKey] = newElement;\r\n          }\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case \"remove\": {\r\n      if (patch.path.startsWith(\"/elements/\")) {\r\n        const elementKey = patch.path.slice(\"/elements/\".length).split(\"/\")[0];\r\n        if (elementKey) {\r\n          const { [elementKey]: _, ...rest } = newTree.elements;\r\n          newTree.elements = rest;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n  }\r\n\r\n  return newTree;\r\n}\r\n\r\n/**\r\n * Options for useUIStream\r\n */\r\nexport interface UseUIStreamOptions {\r\n  /** API endpoint */\r\n  api: string;\r\n  /** Callback when complete */\r\n  onComplete?: (tree: UITree) => void;\r\n  /** Callback on error */\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\n/**\r\n * Return type for useUIStream\r\n */\r\nexport interface UseUIStreamReturn {\r\n  /** Current UI tree */\r\n  tree: UITree | null;\r\n  /** Whether currently streaming */\r\n  isStreaming: boolean;\r\n  /** Error if any */\r\n  error: Error | null;\r\n  /** Send a prompt to generate UI */\r\n  send: (prompt: string, context?: Record<string, unknown>) => Promise<void>;\r\n  /** Clear the current tree */\r\n  clear: () => void;\r\n}\r\n\r\n/**\r\n * Hook for streaming UI generation\r\n */\r\nexport function useUIStream({\r\n  api,\r\n  onComplete,\r\n  onError,\r\n}: UseUIStreamOptions): UseUIStreamReturn {\r\n  const [tree, setTree] = useState<UITree | null>(null);\r\n  const [isStreaming, setIsStreaming] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  const clear = useCallback(() => {\r\n    setTree(null);\r\n    setError(null);\r\n  }, []);\r\n\r\n  const send = useCallback(\r\n    async (prompt: string, context?: Record<string, unknown>) => {\r\n      // Abort any existing request\r\n      abortControllerRef.current?.abort();\r\n      abortControllerRef.current = new AbortController();\r\n\r\n      setIsStreaming(true);\r\n      setError(null);\r\n\r\n      // Start with an empty tree\r\n      let currentTree: UITree = { root: \"\", elements: {} };\r\n      setTree(currentTree);\r\n\r\n      try {\r\n        const response = await fetch(api, {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify({\r\n            prompt,\r\n            context,\r\n            currentTree,\r\n          }),\r\n          signal: abortControllerRef.current.signal,\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP error: ${response.status}`);\r\n        }\r\n\r\n        const reader = response.body?.getReader();\r\n        if (!reader) {\r\n          throw new Error(\"No response body\");\r\n        }\r\n\r\n        const decoder = new TextDecoder();\r\n        let buffer = \"\";\r\n\r\n        while (true) {\r\n          const { done, value } = await reader.read();\r\n          if (done) break;\r\n\r\n          buffer += decoder.decode(value, { stream: true });\r\n\r\n          // Process complete lines\r\n          const lines = buffer.split(\"\\n\");\r\n          buffer = lines.pop() ?? \"\";\r\n\r\n          for (const line of lines) {\r\n            const patch = parsePatchLine(line);\r\n            if (patch) {\r\n              currentTree = applyPatch(currentTree, patch);\r\n              setTree({ ...currentTree });\r\n            }\r\n          }\r\n        }\r\n\r\n        // Process any remaining buffer\r\n        if (buffer.trim()) {\r\n          const patch = parsePatchLine(buffer);\r\n          if (patch) {\r\n            currentTree = applyPatch(currentTree, patch);\r\n            setTree({ ...currentTree });\r\n          }\r\n        }\r\n\r\n        onComplete?.(currentTree);\r\n      } catch (err) {\r\n        if ((err as Error).name === \"AbortError\") {\r\n          return;\r\n        }\r\n        const error = err instanceof Error ? err : new Error(String(err));\r\n        setError(error);\r\n        onError?.(error);\r\n      } finally {\r\n        setIsStreaming(false);\r\n      }\r\n    },\r\n    [api, onComplete, onError],\r\n  );\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      abortControllerRef.current?.abort();\r\n    };\r\n  }, []);\r\n\r\n  return {\r\n    tree,\r\n    isStreaming,\r\n    error,\r\n    send,\r\n    clear,\r\n  };\r\n}\r\n\r\n/**\r\n * Convert a flat element list to a UITree\r\n */\r\nexport function flatToTree(\r\n  elements: Array<UIElement & { parentKey?: string | null }>,\r\n): UITree {\r\n  const elementMap: Record<string, UIElement> = {};\r\n  let root = \"\";\r\n\r\n  // First pass: add all elements to map\r\n  for (const element of elements) {\r\n    elementMap[element.key] = {\r\n      key: element.key,\r\n      type: element.type,\r\n      props: element.props,\r\n      children: [],\r\n      visible: element.visible,\r\n    };\r\n  }\r\n\r\n  // Second pass: build parent-child relationships\r\n  for (const element of elements) {\r\n    if (element.parentKey) {\r\n      const parent = elementMap[element.parentKey];\r\n      if (parent) {\r\n        if (!parent.children) {\r\n          parent.children = [];\r\n        }\r\n        parent.children.push(element.key);\r\n      }\r\n    } else {\r\n      root = element.key;\r\n    }\r\n  }\r\n\r\n  return { root, elements: elementMap };\r\n}\r\n"],"mappings":"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","names":["value","import_react","import_core","import_jsx_runtime","import_react","import_core","import_jsx_runtime","executeAction","import_react","import_core","import_jsx_runtime","value","React","import_jsx_runtime","import_react","import_core","error"]}